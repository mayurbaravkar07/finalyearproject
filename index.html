<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cardiovascular Disease Prediction</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <header>
        <h1>Cardiovascular Disease Prediction</h1>
    </header>

    <section>
        <div class="model-dropdown">
            <select name="Select the Model" id="Model">
                <option value="model1">model1</option>
                <option value="model2">model2</option>
                <option value="model3">model3</option>
            </select>
            <span class="dropdown-arrow">â–¼</span>
        </div>

        <div id="imageContainer">
            <label for="fileInput" class="upload-label">Upload Retinal Image</label>
            <input type="file" id="fileInput" accept="image/*">
            <img id="outputImage" alt="Processed Image" style="display: none;">
        </div>

        <div id="loadingMessage" style="display: none;">
            <div id="loadingSpinner"></div>
            Uploading Image...
        </div>

        <button id="predictButton">Predict</button>

        <div id="result"></div>
    </section>
<script>
    document.getElementById('predictButton').addEventListener('click', () => {
        const selectedModel = document.getElementById('Model').value;
        const fileInput = document.getElementById('fileInput');
        const file = fileInput.files[0];

        console.log('Selected Model:', selectedModel);
        console.log('File:', file);

        const formData = new FormData();
        formData.append('selectedModel', selectedModel);
        formData.append('file', file);

        const xhr = new XMLHttpRequest();
        xhr.open('POST', 'http://127.0.0.1:5000/predict', true);
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4 && xhr.status === 200) {
                const response = JSON.parse(xhr.responseText);
                document.getElementById('result').innerText = response.result;
            }
        };
        xhr.send(formData);
    });

    document.getElementById('fileInput').addEventListener('change', (event) => {
        const outputImage = document.getElementById('outputImage');
        const loadingMessage = document.getElementById('loadingMessage');
        const file = event.target.files[0];

        if (file) {
            const reader = new FileReader();

            reader.onloadstart = function () {
                loadingMessage.style.display = 'block';
            };

            reader.onload = function (e) {
                outputImage.src = e.target.result;
                outputImage.style.display = 'block';
                loadingMessage.style.display = 'none';
            };

            reader.readAsDataURL(file);
        }
    });
</script>

</body>

</html>